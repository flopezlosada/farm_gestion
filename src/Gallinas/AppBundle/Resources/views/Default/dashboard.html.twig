{% extends '::layout_graph.html.twig' %}
 {% block more_css %}
     <link rel="stylesheet" href="{{ asset('bundles/app/css/morris/morris.css') }}"/>
 {% endblock %}

    {% block title_wrapper %}Panel de control{% endblock %}
{% block warning %}{% endblock %}
{% block main %}
    <div class="row">
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-bicycle fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ render(controller('AppBundle:Default:layWeek')) }}</div>
                            <div><br>¡Huevos puestos esta semana!</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('lay_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir puesta</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-green">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-shopping-cart fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ render(controller('AppBundle:Default:collectWeekUser',{'product_id':1})) }}</div>
                            <div>¡Huevos te has llevado esta semana!</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('collect_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir reparto</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-greener">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-barcode fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ " " }}</div>
                            <div><br>Lotes</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('batch_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir tarea</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-yellow">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-eur fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ render(controller('AppBundle:Default:totalSalesAmount')) }}</div>
                            <div>Total de dinero recaudado por las ventas</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('sale_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir venta</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-red">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-12 text-right">
                            <div class="huge">{{ render(controller('AppBundle:Default:lastFeedPurchase')) |localizeddate('short','none','es') }}</div>
                            <div><br>Fecha última compra de pienso</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('purchase_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir compra</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-purple">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-gift fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ " " }}</div>
                            <div><br>Regalos</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('gift_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir regalo</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
        <div class="col-lg-3 col-md-6">
            <div class="panel panel-greener">
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-xs-3">
                            <i class="fa fa-barcode fa-5x"></i>
                        </div>
                        <div class="col-xs-9 text-right">
                            <div class="huge">{{ " " }}</div>
                            <div><br>Lotes</div>
                        </div>
                    </div>
                </div>
                <a href="{{ path('batch_new') }}">
                    <div class="panel-footer">
                        <span class="pull-left">Añadir lote de animales</span>
                        <span class="pull-right"><i class="fa fa-arrow-circle-right"></i></span>

                        <div class="clearfix"></div>
                    </div>
                </a>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-lg-8">
            <div class="panel panel-default">
                <div class="panel-heading">
                    Evolución de la puesta semanal
                </div>
                <div class="panel-body">
                    <div id="layweekchart" style="position: relative;height: 250px;"></div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <i class="fa fa-bell fa-fw"></i> Resumen de datos {{ 'now'|date ('Y') }}
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <div class="list-group">
                        <a class="list-group-item" href="{{ path('statistic_eggs') }}">
                            <i class="fa fa-comment fa-fw"></i> Huevos puestos
                                    <span class="pull-right text-muted small"><em> {{ total_lay_eggs }}</em>
                                    </span>
                        </a>
                        <a class="list-group-item" href="{{ path('statistic_sale') }}">
                            <i class="fa fa-twitter fa-fw"></i> Huevos vendidos
                                    <span class="pull-right text-muted small"><em>{{ total_sale_eggs }}</em>
                                    </span>
                        </a>
                        <a class="list-group-item" href="{{ path('statistic_user_collect',{'user_id':app.user.id}) }}">
                            <i class="fa fa-envelope fa-fw"></i> Huevos que has consumido
                                    <span class="pull-right text-muted small"><em>{{ total_collect_eggs_user }}</em>
                                    </span>
                        </a>
                        <a class="list-group-item" href="{{ path('statistic_feed') }}">
                            <i class="fa fa-tasks fa-fw"></i> Pienso de gallina (Kg)
                                    <span class="pull-right text-muted small"><em>{{ hens_feed_year }}</em>
                                    </span>
                        </a>
                        <a class="list-group-item" href="{{ path('statistic_feed') }}">
                            <i class="fa fa-upload fa-fw"></i> Pienso de pavos (Kg)
                                    <span class="pull-right text-muted small"><em>{{ turkey_feed_year }}</em>
                                    </span>
                        </a>
                        <a class="list-group-item" href="{{ path('statistic_feed') }}">
                            <i class="fa fa-bolt fa-fw"></i> Pienso de pollos (Kg)
                                    <span class="pull-right text-muted small"><em>{{ broiler_feed_year }}</em>
                                    </span>
                        </a>
                    </div>
                    <!-- /.list-group -->
                    <a class="btn btn-default btn-block" href="{{ path('statistic') }}">Ver todas las estadísticas {{ active_hen_batch }}</a>
                </div>
                <!-- /.panel-body -->
            </div>
        </div>
    </div>
{% endblock %}
{% block graph_js %}
    <script>

        new Morris.Line({
            // ID of the element in which to draw the chart.
            element: 'layweekchart',
            // Chart data records -- each entry in this array corresponds to a point on
            // the chart.
            data: [
                {% for week in week_lay %}
                {
                    average: {{ (week.total*active_hen_batch/week.days)|number_format(2,'.',',') }},
                    week: '{{ week.year_date }}-{{ week.week }}',
                    value: {{ week.total }},
                },
                {%  endfor %}
            ],
            // The name of the data record attribute that contains x-values.
            xkey: 'week',
            // A list of names of data record attributes that contain y-values.
            ykeys: ['value', 'average'],
            // Labels for the ykeys -- will be displayed when you hover over the
            // chart.
            labels: ['Huevos', "Media Semanal"],
            hideHover: true,

        });

    </script>
{% endblock %}
